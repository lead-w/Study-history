<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>module | NorthUnicorn</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/Study-history/assets/css/0.styles.e2241fa8.css" as="style"><link rel="preload" href="/Study-history/assets/js/app.a1ad6491.js" as="script"><link rel="preload" href="/Study-history/assets/js/14.30636de0.js" as="script"><link rel="prefetch" href="/Study-history/assets/js/10.7e604d29.js"><link rel="prefetch" href="/Study-history/assets/js/11.3067a7ca.js"><link rel="prefetch" href="/Study-history/assets/js/12.d1a6fe69.js"><link rel="prefetch" href="/Study-history/assets/js/13.4864be39.js"><link rel="prefetch" href="/Study-history/assets/js/15.2bcbbae8.js"><link rel="prefetch" href="/Study-history/assets/js/16.9d7f8d82.js"><link rel="prefetch" href="/Study-history/assets/js/17.0b328dfe.js"><link rel="prefetch" href="/Study-history/assets/js/18.f73ae9e0.js"><link rel="prefetch" href="/Study-history/assets/js/19.0e9a993e.js"><link rel="prefetch" href="/Study-history/assets/js/2.d8f505d4.js"><link rel="prefetch" href="/Study-history/assets/js/20.1a0bbb82.js"><link rel="prefetch" href="/Study-history/assets/js/21.23696e8c.js"><link rel="prefetch" href="/Study-history/assets/js/22.0c73380e.js"><link rel="prefetch" href="/Study-history/assets/js/23.c3ff09bc.js"><link rel="prefetch" href="/Study-history/assets/js/24.7933ac39.js"><link rel="prefetch" href="/Study-history/assets/js/25.c8ae28e2.js"><link rel="prefetch" href="/Study-history/assets/js/26.3736bb12.js"><link rel="prefetch" href="/Study-history/assets/js/27.97f3f560.js"><link rel="prefetch" href="/Study-history/assets/js/28.fa4268d5.js"><link rel="prefetch" href="/Study-history/assets/js/29.50a00a75.js"><link rel="prefetch" href="/Study-history/assets/js/3.8796f9d7.js"><link rel="prefetch" href="/Study-history/assets/js/30.25371944.js"><link rel="prefetch" href="/Study-history/assets/js/31.b1b8fd04.js"><link rel="prefetch" href="/Study-history/assets/js/32.f534b2b4.js"><link rel="prefetch" href="/Study-history/assets/js/33.b9e3298a.js"><link rel="prefetch" href="/Study-history/assets/js/34.8ac7105e.js"><link rel="prefetch" href="/Study-history/assets/js/35.ba4dfc73.js"><link rel="prefetch" href="/Study-history/assets/js/36.ef19edf1.js"><link rel="prefetch" href="/Study-history/assets/js/37.0f9caf07.js"><link rel="prefetch" href="/Study-history/assets/js/38.2e4a8c9a.js"><link rel="prefetch" href="/Study-history/assets/js/39.46f87030.js"><link rel="prefetch" href="/Study-history/assets/js/4.c59777f9.js"><link rel="prefetch" href="/Study-history/assets/js/40.e1794eae.js"><link rel="prefetch" href="/Study-history/assets/js/41.5507fc07.js"><link rel="prefetch" href="/Study-history/assets/js/42.caa5814b.js"><link rel="prefetch" href="/Study-history/assets/js/43.6cd8bb3f.js"><link rel="prefetch" href="/Study-history/assets/js/44.2442f75f.js"><link rel="prefetch" href="/Study-history/assets/js/45.9648c0bd.js"><link rel="prefetch" href="/Study-history/assets/js/46.de6e3a74.js"><link rel="prefetch" href="/Study-history/assets/js/47.72c2c6ba.js"><link rel="prefetch" href="/Study-history/assets/js/48.d5004b5b.js"><link rel="prefetch" href="/Study-history/assets/js/49.a2d1d664.js"><link rel="prefetch" href="/Study-history/assets/js/5.9b395665.js"><link rel="prefetch" href="/Study-history/assets/js/50.19b7d6c9.js"><link rel="prefetch" href="/Study-history/assets/js/51.a9a0da08.js"><link rel="prefetch" href="/Study-history/assets/js/52.e99771cc.js"><link rel="prefetch" href="/Study-history/assets/js/53.74e55a43.js"><link rel="prefetch" href="/Study-history/assets/js/54.c4ff7ebc.js"><link rel="prefetch" href="/Study-history/assets/js/55.acadfba7.js"><link rel="prefetch" href="/Study-history/assets/js/56.8fa49260.js"><link rel="prefetch" href="/Study-history/assets/js/57.08f5f4e4.js"><link rel="prefetch" href="/Study-history/assets/js/58.9d13dd4c.js"><link rel="prefetch" href="/Study-history/assets/js/6.d5fd31a3.js"><link rel="prefetch" href="/Study-history/assets/js/7.ec2eb6b8.js"><link rel="prefetch" href="/Study-history/assets/js/8.91dd34c9.js"><link rel="prefetch" href="/Study-history/assets/js/9.814e5587.js">
    <link rel="stylesheet" href="/Study-history/assets/css/0.styles.e2241fa8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Study-history/" class="home-link router-link-active"><!----> <span class="site-name">NorthUnicorn</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Study-history/front/" class="nav-link">front</a></div><div class="nav-item"><a href="/Study-history/houduan/" class="nav-link">back</a></div><div class="nav-item"><a href="/Study-history/devOps/" class="nav-link">devOps</a></div><div class="nav-item"><a href="/Study-history/interview/" class="nav-link">interview</a></div><div class="nav-item"><a href="/Study-history/article/" class="nav-link router-link-active">article</a></div><div class="nav-item"><a href="https://github.com/songge7777" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Study-history/front/" class="nav-link">front</a></div><div class="nav-item"><a href="/Study-history/houduan/" class="nav-link">back</a></div><div class="nav-item"><a href="/Study-history/devOps/" class="nav-link">devOps</a></div><div class="nav-item"><a href="/Study-history/interview/" class="nav-link">interview</a></div><div class="nav-item"><a href="/Study-history/article/" class="nav-link router-link-active">article</a></div><div class="nav-item"><a href="https://github.com/songge7777" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>article</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Study-history/article/webpack5.html" class="sidebar-link">webpack5 更新版本</a></li><li><a href="/Study-history/article/webpack.html" class="sidebar-link">webpack(基础)</a></li><li><a href="/Study-history/article/module.html" class="active sidebar-link">module</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Study-history/article/module.html#es6模块" class="sidebar-link">es6模块</a></li><li class="sidebar-sub-header"><a href="/Study-history/article/module.html#commonjs模块" class="sidebar-link">CommonJS模块</a></li></ul></li><li><a href="/Study-history/article/vueAnalysis.html" class="sidebar-link">vue</a></li><li><a href="/Study-history/article/vueN.html" class="sidebar-link">vue</a></li><li><a href="/Study-history/article/promise.html" class="sidebar-link">promise &amp;&amp; Event Loop</a></li><li><a href="/Study-history/article/frontModle.html" class="sidebar-link">发布订阅模式&amp;&amp;观察者模式</a></li><li><a href="/Study-history/article/vuePlugin.html" class="sidebar-link">vuePlugin</a></li><li><a href="/Study-history/article/jwtPrinciple.html" class="sidebar-link">jwt</a></li><li><a href="/Study-history/article/routerAuth.html" class="sidebar-link">routerAuth</a></li><li><a href="/Study-history/article/statusCode.html" class="sidebar-link">常用的状态码</a></li><li><a href="/Study-history/article/useLibrary.html" class="sidebar-link">常用库</a></li><li><a href="/Study-history/article/reg.html" class="sidebar-link">正则</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>vue</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Study-history/article/vueSource.html" class="sidebar-link">vue source</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>axios</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Study-history/article/axios.html" class="sidebar-link">axios</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>upload</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Study-history/article/upload.html" class="sidebar-link">upload</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>binary</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Study-history/article/binary.html" class="sidebar-link">二进制</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>http</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Study-history/article/http.html" class="sidebar-link">http</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="module"><a href="#module" aria-hidden="true" class="header-anchor">#</a> module</h1> <p></p><div class="table-of-contents"><ul><li><a href="#es6模块">es6模块</a><ul><li><a href="#export命令">export命令</a></li><li><a href="#import命令">import命令</a></li><li><a href="#整体模块加载">整体模块加载</a></li><li><a href="#export-default命令">export default命令</a></li><li><a href="#复合写法">复合写法</a></li><li><a href="#import">import()</a></li></ul></li><li><a href="#commonjs模块">CommonJS模块</a><ul><li><a href="#具体两大差异">具体两大差异</a></li><li><a href="#相互加载问题">相互加载问题</a></li></ul></li></ul></div><p></p> <ul><li>js模块主要分前端的es6模块和node的CommonJS模块,他们两个有很大的区别,但目的是一样,都是引入文件,在大项目中起到至关重要的作用.下面我将介绍下他们的基本用法、区别以及循环加载的难点</li></ul> <h2 id="es6模块"><a href="#es6模块" aria-hidden="true" class="header-anchor">#</a> es6模块</h2> <h3 id="export命令"><a href="#export命令" aria-hidden="true" class="header-anchor">#</a> export命令</h3> <ul><li>es6模块主要由两个命令构成:export和import。export命令式用于模块的对外接口，而import命令用于输入其他模块提供的功能。可以这么理解模块，一个文件即为一个模块，外面文件想获取模块内的变量(包括函数和类)，就必须用export 导出变量。as关键字 默认情况下export输出的变量就是本来的名字 通过as 可以重命名。</li> <li>特性：export语句输出的接口与其对应的值是动态绑定的关系，若是有定时器更改值 最后导出的值是最新(定时器修改后的值)</li> <li>写法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1、</span>
<span class="token keyword">export</span> <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>b<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 2、export{} 这个大括号表示批量导出 用的时候需要结构 {}不是对象</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">export</span><span class="token punctuation">{</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>f<span class="token punctuation">}</span>
<span class="token comment">// 3、</span>
<span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>fn1 <span class="token keyword">as</span> stream1<span class="token punctuation">,</span>fn2 <span class="token keyword">as</span> stream2<span class="token punctuation">}</span>
</code></pre></div><h3 id="import命令"><a href="#import命令" aria-hidden="true" class="header-anchor">#</a> import命令</h3> <ul><li>与export对应的 即是import命令,export {}导出 ,import {} from 'xx.js' 引入。export导出的内容 import都要用{}，大括号内的值要跟export导出的值对应上。同时也可以用as进行重命名。文件的名字可以是相对路径也可以是绝对路径。import 命令具有提升效果的作用，会提升到整个模块的头部首先执行，有点类似变量提升。import 语句会执行所有的模块加载，相同的只执行一次</li> <li>写法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// import命令 参考export 例子</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>f<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'xx.js'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>a <span class="token keyword">as</span> a1<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'xx.js'</span>
<span class="token comment">// import 语句,多次加载 相同的只执行一次</span>
<span class="token keyword">import</span> <span class="token string">'xxx.js'</span>
<span class="token keyword">import</span> <span class="token string">'xxx.js'</span>
</code></pre></div><h3 id="整体模块加载"><a href="#整体模块加载" aria-hidden="true" class="header-anchor">#</a> 整体模块加载</h3> <ul><li>上面说到import {} 里面写入每一个要加载的变量,当变量很多的时候，我们可以用*代替，*里面包含了所有导出的内容，使用的时候 需要那个直接调用他即可</li> <li>写法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// export 导出</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// import</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token operator">*</span> <span class="token keyword">as</span> fn<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'xx.js'</span>
<span class="token comment">// fn.fn1 即 fn1 </span>
<span class="token comment">// fn.fn2 即 fn2 </span>
</code></pre></div><h3 id="export-default命令"><a href="#export-default命令" aria-hidden="true" class="header-anchor">#</a> export default命令</h3> <ul><li>前面说到import {} 内需要知道所有的变量，或者用*来代替,否则无法加载。因为export是一个个导出的 所以需要import一个个加载。现在有一种叫默认导出 即export default 变量,一个模块只能有一个这样的语句。所以import 引入的时候 就不需要加{} 直接写变量名，而且变量名不需要跟exoprt 导出的进行关联。默认导出的函数有名字和没名字都一样</li> <li>写法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> a<span class="token punctuation">;</span>
  <span class="token comment">// 默认导出 </span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">// 引入</span>
  <span class="token keyword">import</span> fn <span class="token keyword">from</span> <span class="token string">'xxx.js'</span>
</code></pre></div><h3 id="复合写法"><a href="#复合写法" aria-hidden="true" class="header-anchor">#</a> 复合写法</h3> <ul><li>复合写法即一个模块中既有输入也有输出</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>es6<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'xx'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> es6
<span class="token comment">// 复合写法</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>es6<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'xx'</span>
</code></pre></div><h3 id="import"><a href="#import" aria-hidden="true" class="header-anchor">#</a> import()</h3> <ul><li>export 和 import 命令只能在模块的顶层，不能再代码块中(比如,if代码或者函数)。而import()就没有这个限制,import()是动态加载的，他执行后的结果返回一个promise，他再运行时执行。import()类似node里面的require方法，前者是异步而后者是同步加载。import()很合适做按需加载，也就是等需要的时候，我们再去import模块，返回的结构就是promise，若是多个按需加载的处理，就是操作promise。</li></ul> <h2 id="commonjs模块"><a href="#commonjs模块" aria-hidden="true" class="header-anchor">#</a> CommonJS模块</h2> <ul><li>基本用法，exports.变量 是单个输出 通过require获取到，类似es6的export。module.exports是整体输出 同样通过require获取，类似es6的export default。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>  exports<span class="token punctuation">.</span>done <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token comment">// 单个输出</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>a<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token comment">// 整体输出</span>

  <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'xxx.js'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="具体两大差异"><a href="#具体两大差异" aria-hidden="true" class="header-anchor">#</a> 具体两大差异</h3> <ul><li>CommonJs 模块输出的是一个值的复制,但是传递对象的时候(两边都延迟了,对象传递的值被延时修改,延时获取的对象值也会发生变化,基本类型不会变)</li> <li>es6模块输出的是值的引用 export default导出的是值(是不会变的),export {} 导出的是变量(会变)</li> <li>CommonJs 模块是运行时候加载，es6模块是编译时输出接口</li></ul> <h3 id="相互加载问题"><a href="#相互加载问题" aria-hidden="true" class="header-anchor">#</a> 相互加载问题</h3> <ul><li>import命令加载CommonJS,module.exports等同于export default</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1、整体输出</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>foo<span class="token punctuation">:</span><span class="token string">'foo'</span><span class="token punctuation">}</span>
<span class="token keyword">import</span> foo <span class="token keyword">from</span> <span class="token string">'xxx.js'</span>
</code></pre></div><ul><li>require命令加载es6模块 结果再require的default中，require存在缓存机制 es.js对foo重新赋值没有在模块外部反映出来</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// es.js</span>
  <span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span>bar<span class="token punctuation">:</span><span class="token string">'xxx'</span><span class="token punctuation">}</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> foo
  foo <span class="token operator">==</span> <span class="token keyword">null</span>
<span class="token comment">// cjs.js</span>
  <span class="token keyword">const</span>  a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'es.js'</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>default<span class="token punctuation">)</span> <span class="token comment">// {bar:'xxx'}</span>
</code></pre></div><ul><li>循环加载，指的是a脚本执行依赖b脚本，b脚本执行依赖a脚本。</li> <li>CommonJS模块加载原理，require命令第一次加载该脚本就会执行整个脚本，在内存中生成一个对象，对象里面有id(模块的命),exports是属性模块输出的各个接口,loaded属性是一个布尔值,表示模块的脚本是否执行完毕，还有其他的属性。要用到模块就去会exports上面取值，后面多次执行require也不会执行该模块，而是在缓存中取值。CommonJS模块无论加载多少次，都只会在第一次加载时运行一次，以后再加载就去缓存中的值,除非手动清楚缓存。</li> <li>一旦出现某个模块被&quot;循环加载&quot;，就只输出已经执行的部分，还未执行的部分不会输出,也就是说进入循环引用的时候 引入的只是已经执行过的代码.</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// a.js</span>
exports<span class="token punctuation">.</span>fl <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'b.js'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`a.js ===&gt; fl:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>b<span class="token punctuation">.</span>fl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>
exports<span class="token punctuation">.</span>fl <span class="token operator">=</span> <span class="token boolean">true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`a.js ===&gt; 执行完成`</span></span><span class="token punctuation">)</span>

<span class="token comment">// b.js</span>
exports<span class="token punctuation">.</span>fl <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'/a.js'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`b.js ===&gt; fl:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>a<span class="token punctuation">.</span>fl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>
exports<span class="token punctuation">.</span>fl <span class="token operator">=</span> <span class="token boolean">true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`b.js ===&gt; 执行完毕`</span></span><span class="token punctuation">)</span>

<span class="token comment">// index.js</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'/a.js'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'/b.js'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">` 代码执行完毕: a ===&gt; fl:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>a<span class="token punctuation">.</span>fl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">; b ===&gt; fl:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>b<span class="token punctuation">.</span>fl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**
  b.js ===&gt; fl:flase
  b.js ===&gt; 执行完毕
  a.js ===&gt; fl:true
  a.js ===&gt; 执行完毕
  代表执行完毕: a ==&gt; fl:true; b ==&gt; fl:true
*/</span>
</code></pre></div><ul><li>ES6模块的运行机制与CommonJS不一样，它遇到模块加载命令import时，不会去执行模块，而是只生成一个引用。等到真的需要用到时，再到模块里面去取值。当es6模块循环引用的时候 如 a.js 引入 b.js，b.js 引入 a.js，由于a.js 已经开始执行了 所以不会重复执行 开始执行b.js</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// a.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>bar<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./b.js'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'执行完毕'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// b.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>foo<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./a.js'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'b.js'</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// a.js</span>
<span class="token comment">// b.js</span>
<span class="token comment">// 执行完毕</span>

<span class="token comment">// 执行结果也有可能</span>
<span class="token comment">// a.js</span>
<span class="token comment">// b.js</span>
<span class="token comment">// a.js</span>
<span class="token comment">// b.js</span>
<span class="token comment">// 执行完毕</span>
<span class="token comment">// 执行完毕</span>
</code></pre></div><ul><li>下面的代码中，参数n从10变为0的过程中，even()一共会执行6次，所以变量counter等于6。第二次调用even()时，参数n从20变为0，even()一共会执行11次，加上前面的6次，所以变量counter等于17</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// even.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> odd <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./odd'</span>
<span class="token keyword">export</span> <span class="token keyword">var</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">even</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  counter<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> n <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token function">odd</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token comment">// odd.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> even <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./even'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">odd</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> n <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">even</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


$ babel<span class="token operator">-</span>node
<span class="token operator">&gt;</span> <span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> m <span class="token keyword">from</span> <span class="token string">'./even.js'</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> m<span class="token punctuation">.</span><span class="token function">even</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token boolean">true</span>
<span class="token operator">&gt;</span> m<span class="token punctuation">.</span>counter
<span class="token number">6</span>
<span class="token operator">&gt;</span> m<span class="token punctuation">.</span><span class="token function">even</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token boolean">true</span>
<span class="token operator">&gt;</span> m<span class="token punctuation">.</span>counter
<span class="token number">17</span>
</code></pre></div></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">11/7/2022, 8:03:51 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/Study-history/article/webpack.html" class="prev">
          webpack(基础)
        </a></span> <span class="next"><a href="/Study-history/article/vueAnalysis.html">
          vue
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/Study-history/assets/js/app.a1ad6491.js" defer></script><script src="/Study-history/assets/js/14.30636de0.js" defer></script>
  </body>
</html>
